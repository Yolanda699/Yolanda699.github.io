---
title: "<span style='font-size: 30px;'>Univariate Analysis</span><span style='font-size: 20px; color:gray;'> [Demographic Characteristics] </span>"
---
<span style='background-color:#fdfd96;'>How does each demographic characteristic affect the drug consumption patterns?</span>

[This univariate analysis page will feature an analysis of four key demographic factors: ***Age, Gender, Education Level, and Country***. The aim is to elucidate their relationship with drug consumption patterns.]{style="font-size: 12pt; color: gray;"}

```{r, eval=TRUE, echo=FALSE}
drug <- read.csv("Drug_Consumption_Quantified.csv")
drug <- subset(drug, Country != "-0.28519")
drug_or <- read.csv("Drug_Consumption.csv")
drug_or <- subset(drug_or, Country != "Other")
```

### **Legal** Drugs 
These three drugs (alcohol, cafeeine and nocotine) are legal in all 6 analyzed countries.

#### Alcohol
##### Age
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

# Define breaks and labels for age groups
breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

# Create a histogram faceted by each level of alcohol consumption
ggplot(drug, aes(x = factor(Age, labels = labels), fill = factor(Age, labels = labels))) +
  geom_bar(color = "black", position = "dodge") +
  facet_wrap(~ Alcohol, nrow = 1) +
  labs(title = "Age Distribution by Alcohol Consumption Level", x = NULL, y = "Frequency") +  # Removed x-axis label
  theme_minimal() +
  theme(axis.text.x = element_blank())  # Removed x-axis text

```

##### Gender
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)
library(dplyr)


# Calculate counts of each gender in each level of alcohol consumption
count_data <- drug_or %>%
  group_by(Alcohol, Gender) %>%
  summarise(count = n())

# Define custom colors
custom_colors <- c("M" = "#106898", "F" = "#615ea8")

# Create a histogram comparing alcohol consumption levels between genders
ggplot(count_data, aes(x = Alcohol, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Distribution of Alcohol Consumption Levels by Gender", x = "Alcohol Consumption Levels (CL0-CL6)", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

##### Education
##### Country

#### Caffeine
##### Age
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Caff)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Caffeine", title = "Age vs. Caffeine")
```

##### Gender
##### Education
##### Country

#### Nicotine
##### Age
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Nicotine)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Nicotine", title = "Age vs. Nicotine")
```

##### Gender
##### Education
##### Country

### **Controversial** Drugs
This drug (cannabis) is legal in two analyzed countries (the United States and Canada) but illegal in four others.

#### Cannabis
##### Age
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Cannabis)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Cannabis", title = "Age vs. Cannabis")
```

##### Gender
##### Education
##### Country

### **Illegal** Drugs 
These two drugs (Cocaine, Heroin) are illegal across all six analyzed countries.

#### Cocaine
##### Age
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Coke)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Cocaine", title = "Age vs. Cocaine")
```
##### Gender
##### Education
##### Country

#### Heroin
##### Age
```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Heroin)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Heroin", title = "Age vs. Heroin")
```

##### Gender
##### Education
##### Country
