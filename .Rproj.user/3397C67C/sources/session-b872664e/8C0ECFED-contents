---
title: "<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>"
---

[How does each demographic characteristic affect the drug consumption patterns?]{style="background-color:#fdfd96;"}

[This univariate analysis page will feature an analysis of four key demographic factors: ***Age, Gender, Education Level, and Country***. The aim is to elucidate their relationship with drug consumption patterns.<br><br> **For reference:** CL0 indicating ‘never used’, CL1 representing ‘used over a decade ago’, CL2 indicating ‘used in the last decade’, CL3 indicating ‘used in the last year’, CL4 representing ‘used in the last month’, CL5 indicating ‘used in the last week’, and CL6 representing ‘used in the last day’. <br><br> **Note:** This dataset contains 1766 participants, with 905 females and 861 males.]{style="font-size: 12pt; color: gray;"}

```{r, eval=TRUE, echo=FALSE}
drug <- read.csv("Drug_Consumption_Quantified.csv")
drug <- subset(drug, Country != "-0.28519")
drug_or <- read.csv("Drug_Consumption.csv")
drug_or <- subset(drug_or, Country != "Other")
```

## **Legal** Drugs

These three drugs (alcohol, cafeeine and nocotine) are legal in all 6 analyzed countries.

### Alcohol

The majority of participants consume alcohol with some regularity, with monthly (CL4), weekly (CL5), or daily (CL6) consumption being the most reported.

**Younger people consume more:** Younger individuals are more likely to have engaged in alcohol consumption more recently, while older age groups show a higher frequency of alcohol consumption in the more distant past, with a notable decline in recent consumption as age progresses.

**Minor gender difference:** While overall gender differences in alcohol consumption appear minimal, there are specific points of divergence. Despite these variations, both genders display a similar pattern of alcohol consumption, with the majority having consumed alcohol at some stage and only a small proportion never having consumed alcohol at all.

**Higher educational level might bring more consumption:** The relationship between education and alcohol consumption is not strongly marked at the lower consumption levels or distant past (CL0 to CL3). Still, a trend emerges at the higher levels of recent alcohol use (CL4 to CL6), where individuals with higher education, such as university graduates, show a tendency towards more frequent alcohol consumption. Higher education may influence alcohol consumption habits, leading to more frequent use among these individuals.

**Minor country difference:** Alcohol consumption is a widespread phenomenon with similar levels of engagement across the countries surveyed, pointing to the absence of notable distinctions in alcohol consumption habits based on country.

#### Age

There is an observable overall decline in alcohol consumption as age increases. The proportion of individuals who have never consumed alcohol (CL0) diminishes with advancing age. The peak occurrence for those who last consumed alcohol over a decade ago (CL1) is found within the 45-54 age bracket. The age group most likely to have consumed alcohol in the last decade (CL2) is 35-44. For more recent consumption categories—consumed in the last year (CL3), last month (CL4), last week (CL5), and last day (CL6)—the majority are in the youngest age group, 18-24.

```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Alcohol)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Alcohol", title = "Age and Alcohol Consumption")
```

#### Gender

A smaller portion of the surveyed population, 16.68% of females and 19.05% of males, includes individuals who have never consumed alcohol (CL0) or those who last consumed alcohol up to a year ago (CL3). The overall data suggests that the difference in alcohol consumption patterns between genders is negligible. The largest observed difference is in the weekly consumption category (CL5), where 42.98% of females and 37.51% of males reported consumption, yet this difference is not considered significant.

```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

count_data <- drug_or %>%
  group_by(Alcohol, Gender) %>%
  summarise(count = n())

custom_colors <- c("F" = "#aed0ee", "M" = "#a3bbdb")

ggplot(count_data, aes(x = Alcohol, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Gender and Alcohol Consumption", x = "Alcohol Consumption Levels", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

#### Education

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)

labels <- c("Doctorate degree", "Masters degree", "University degree", "Professional certificate/ diploma", "Some college or university, no certificate or degree", "Left school at 18 years", "Left school at 17 years", "Left school at 16 years", "Left school before 16 years")

custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460", "#12264f")

ggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Alcohol, nrow = 4) +
  labs(title = "Education and Alcohol Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

#### Country

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)

# Define breaks and labels for alcohol consumption levels (CL0-CL6)
breaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)
labels <- c("Australia", "Canada", "New Zealand", "Republic of Ireland", "UK", "USA")

# Define custom colors for each country
custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba")
ggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Alcohol, nrow = 3) +
  labs(title = "Country and Alcohol Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

### Caffeine

**Younger people consume more:** Younger adults exhibiting more frequent usage. This trend suggests that caffeine consumption may decrease as individuals age, particularly after passing the 55-year mark.

**Minor gender difference:** Both males and females exhibit similar patterns of caffeine consumption, with both genders showing a high level of caffeine intake. There is no significant gender difference influencing the frequency of caffeine consumption.

#### Age

The data suggests that weekly (CL5) and daily (CL6) caffeine consumption is predominantly observed in the younger age brackets, specifically those aged 18-24 and 25-34. There is a noticeable decline in caffeine consumption among individuals in the 55-64 age group. Furthermore, the peak of caffeine consumption 'over a decade ago' (CL1) is most evident in the 35-44 age category, which aligns with the finding that caffeine consumption is most prevalent among those currently in the 18-24 and 25-34 age groups.

```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Caff)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Caffeine", title = "Age and Caffeine Consumption")
```

#### Gender

The majority of surveyed individuals consume caffeine either on a daily basis (CL6), with 24.64% female and 29.15% male respondents, or on a weekly basis (CL5), with 42.98% females and 37.51% males. However, the gender difference in caffeine consumption frequency is not significantly pronounced.

```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

count_data <- drug_or %>%
  group_by(Caff, Gender) %>%
  summarise(count = n())

custom_colors <- c("F" = "#aed0ee", "M" = "#a3bbdb")

ggplot(count_data, aes(x = Caff, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Gender and Caffeine Consumption", x = "Caffeine Consumption Levels", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

#### Education

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)
labels <- c("Doctorate degree", "Masters degree", "University degree", "Professional certificate/ diploma", "Some college or university, no certificate or degree", "Left school at 18 years", "Left school at 17 years", "Left school at 16 years", "Left school before 16 years")

custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460", "#12264f")


ggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Caff, nrow = 4) +
  labs(title = "Country and Caffeine Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

#### Country

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)

# Define breaks and labels for alcohol consumption levels (CL0-CL6)
breaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)
labels <- c("Australia", "Canada", "New Zealand", "Republic of Ireland", "UK", "USA")

# Define custom colors for each country
custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba")

ggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Caff, nrow = 3) +
  labs(title = "Country and Caffeine Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

### Nicotine

#### Age

```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Nicotine)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Nicotine", title = "Age and Nicotine Consumption")
```

#### Gender

```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

count_data <- drug_or %>%
  group_by(Nicotine, Gender) %>%
  summarise(count = n())

custom_colors <- c("F" = "#aed0ee", "M" = "#a3bbdb")

ggplot(count_data, aes(x = Nicotine, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Gender and Nicotine Consumption", x = "Nicotine Consumption Levels", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

#### Education

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)
labels <- c("Doctorate degree", "Masters degree", "University degree", "Professional certificate/ diploma", "Some college or university, no certificate or degree", "Left school at 18 years", "Left school at 17 years", "Left school at 16 years", "Left school before 16 years")

custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460", "#12264f")


ggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Nicotine, nrow = 4) +
  labs(title = "Education and Nicotine Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

#### Country

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)

# Define breaks and labels for alcohol consumption levels (CL0-CL6)
breaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)
labels <- c("Australia", "Canada", "New Zealand", "Republic of Ireland", "UK", "USA")

# Define custom colors for each country
custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba")

ggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Nicotine, nrow = 3) +
  labs(title = "Country and Nicotine Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

## **Controversial** Drugs

This drug (cannabis) is legal in two analyzed countries (the United States and Canada) but illegal in four others.

### Cannabis

#### Age

```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Cannabis)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Cannabis", title = "Age and Cannabis Consumption")
```

#### Gender

```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

count_data <- drug_or %>%
  group_by(Cannabis, Gender) %>%
  summarise(count = n())

custom_colors <- c("F" = "#aed0ee", "M" = "#a3bbdb")

ggplot(count_data, aes(x = Cannabis, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Gender and Cannabis Consumption", x = "Cannabis Consumption Levels", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

#### Education

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)
labels <- c("Doctorate degree", "Masters degree", "University degree", "Professional certificate/ diploma", "Some college or university, no certificate or degree", "Left school at 18 years", "Left school at 17 years", "Left school at 16 years", "Left school before 16 years")

custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460", "#12264f")


ggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Cannabis, nrow = 4) +
  labs(title = "Education and Cannabis Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

#### Country

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)

# Define breaks and labels for alcohol consumption levels (CL0-CL6)
breaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)
labels <- c("Australia", "Canada", "New Zealand", "Republic of Ireland", "UK", "USA")

# Define custom colors for each country
custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba")

ggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Cannabis, nrow = 3) +
  labs(title = "Country and Cannabis Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

## **Illegal** Drugs

These two drugs (Cocaine, Heroin) are illegal across all six analyzed countries.

### Cocaine

#### Age

```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Coke)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Cocaine", title = "Age and Cocaine Consumption")
```

#### Gender

```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

count_data <- drug_or %>%
  group_by(Coke, Gender) %>%
  summarise(count = n())

custom_colors <- c("F" = "#aed0ee", "M" = "#a3bbdb")

ggplot(count_data, aes(x = Coke, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Gender and Cocaine Consumption", x = "Cocaine Consumption Levels", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

#### Education

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)
labels <- c("Doctorate degree", "Masters degree", "University degree", "Professional certificate/ diploma", "Some college or university, no certificate or degree", "Left school at 18 years", "Left school at 17 years", "Left school at 16 years", "Left school before 16 years")

custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460", "#12264f")


ggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Coke, nrow = 4) +
  labs(title = "Education and Cocaine Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

#### Country

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)

# Define breaks and labels for alcohol consumption levels (CL0-CL6)
breaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)
labels <- c("Australia", "Canada", "New Zealand", "Republic of Ireland", "UK", "USA")

# Define custom colors for each country
custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba")

ggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Coke, nrow = 3) +
  labs(title = "Country and Cocaine Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

### Heroin

#### Age

```{r, eval=TRUE, echo=FALSE}
library(ggplot2)

breaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)
labels <- c("18-24", "25-34", "35-44", "45-54", "55-64", "65+")

ggplot(drug, aes(x = Age, y = Heroin)) +
  geom_violin() +
  scale_x_continuous(breaks = breaks, labels = labels) +
  labs(x = "Age", y = "Heroin", title = "Age and Heroin Consumption")
```

#### Gender

```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)

count_data <- drug_or %>%
  group_by(Heroin, Gender) %>%
  summarise(count = n())

custom_colors <- c("F" = "#aed0ee", "M" = "#a3bbdb")

ggplot(count_data, aes(x = Heroin, y = count, fill = Gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +
  labs(title = "Gender and Heroin Consumption", x = "Heroin Consumption Levels", y = "Count") +
  scale_fill_manual(values = custom_colors) +
  theme_minimal()
```

#### Education

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)

breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)
labels <- c("Doctorate degree", "Masters degree", "University degree", "Professional certificate/ diploma", "Some college or university, no certificate or degree", "Left school at 18 years", "Left school at 17 years", "Left school at 16 years", "Left school before 16 years")

custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460", "#12264f")


ggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Heroin, nrow = 4) +
  labs(title = "Education and Heroin Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```

#### Country

```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)

# Define breaks and labels for alcohol consumption levels (CL0-CL6)
breaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)
labels <- c("Australia", "Canada", "New Zealand", "Republic of Ireland", "UK", "USA")

# Define custom colors for each country
custom_colors <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba")

ggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +
  geom_bar(position = "dodge") +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
  facet_wrap(~ Heroin, nrow = 3) +
  labs(title = "Country and Heroin Consumption", x = "", y = "Count" ) +
  theme_minimal() +
  theme(axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        legend.text = element_text(size = 6),
        legend.key.size = unit(0.5, "cm")) +
  scale_fill_manual(values = custom_colors) +
  guides(fill = guide_legend(title = "Education")) +
  ylim(0,250)
```
