# Create the pie chart
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +
  facet_wrap(~ Education, ncol = 3, labeller = label_wrap_gen(width = 20)) + # Adjust the number of columns as needed
  scale_fill_manual(values = custom_colours) + # Use the custom colours
  geom_text(aes(label = ifelse(percentage > 5, paste0(round(percentage, 0), "%"), "")),
            position = position_stack(vjust = 0.5), # Adjust vertical justification
            colour = "white", size = 2, angle = 0) + # Adjust text size and colour
  labs(title = "Education and Alcohol Consumption",
       x = "", y = "", fill = "Alcohol Category") +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.direction = "horizontal",
        legend.title = element_text(size = 8),
        legend.text = element_text(size = 6),
        strip.text.x = element_text(size = 8), # Adjust facet labels
        plot.margin = margin(20, 20, 20, 20, "mm"), # Adjust plot margins for better display
        axis.text.x = element_blank(), # Remove x-axis labels (radial lines indicating percentages)
        axis.text.y = element_blank(), # Remove y-axis labels
        axis.ticks = element_blank(), # Remove axis ticks
        aspect.ratio = 1) # Set aspect ratio for circular plot