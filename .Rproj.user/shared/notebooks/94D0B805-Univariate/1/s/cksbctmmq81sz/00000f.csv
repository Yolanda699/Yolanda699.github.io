"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(scales)"
"0",""
"0","breaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)"
"0",""
"0","labels <- c(""Doctorate degree"", ""Masters degree"", ""University degree"", ""Professional certificate/ diploma"", ""Some college or university, no certificate or degree"", ""Left school at 18 years"", ""Left school at 17 years"", ""Left school at 16 years"", ""Left school before 16 years"")"
"0","custom_colors <- c(""#aed0ee"", ""#a3bbdb"", ""#88abda"", ""#8aabcc"", ""#6f94cd"", ""#5976ba"", ""#106898"", ""#12507b"", ""#003460"", ""#12264f"")"
"0",""
"0","education_alcohol_counts <- drug %>%"
"0","  group_by(Alcohol, Education) %>%"
"0","  summarise(Count = n_distinct(ID)) %>%"
"0","  mutate(Percent = Count / sum(Count)) %>%"
"0","  ungroup()"
"0",""
"0","# Plot pie charts for each CL category, showing percentage"
"0","ggplot(education_alcohol_counts, aes(x = factor(1), y = Percent, fill = factor(Education))) +"
"0","  geom_bar(stat = ""identity"", width = 1) +"
"0","  coord_polar(theta = ""y"") +"
"0","  facet_wrap(~ Alcohol, ncol = 4) + # Adjust the number of columns as needed"
"0","  scale_y_continuous(labels = percent_format()) +"
"0","  geom_text(aes(label = ifelse(Percent > 0.05, scales::percent(Percent, accuracy = 1), """")), # Only label segments larger than 5%"
"0","            position = position_stack(vjust = 0.5),"
"0","            color = ""white"", # Change label color to white"
"0","            size = 2) +"
"0","  labs(title = ""Alcohol Consumption by Educational Level"", x = """", y = """", fill = ""Education"") +"
"0","  theme_void() +"
"0","  theme(legend.position = ""bottom"","
"0","        legend.key.size = unit(0.5, ""cm""),"
"0","        legend.text = element_text(size = 6)) +"
"0","  scale_fill_manual(values = custom_colors)"
