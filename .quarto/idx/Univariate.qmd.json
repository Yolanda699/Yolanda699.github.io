{"title":"<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>","markdown":{"yaml":{"title":"<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>"},"headingText":"**Legal** Drugs","containsRefs":false,"markdown":"\n\n[How does each demographic characteristic affect the drug consumption patterns?]{style=\"background-color:#fdfd96;\"}\n\n[This univariate analysis page will feature an analysis of four key demographic factors: ***Age, Gender, Education Level, and Country***. The aim is to elucidate their relationship with drug consumption patterns.<br><br> **For reference:** CL0 indicating ‘never used’, CL1 representing ‘used over a decade ago’, CL2 indicating ‘used in the last decade’, CL3 indicating ‘used in the last year’, CL4 representing ‘used in the last month’, CL5 indicating ‘used in the last week’, and CL6 representing ‘used in the last day’.]{style=\"font-size: 12pt; color: gray;\"}\n\n```{r, eval=TRUE, echo=FALSE}\ndrug <- read.csv(\"Drug_Consumption_Quantified.csv\")\ndrug <- subset(drug, Country != \"-0.28519\")\ndrug_or <- read.csv(\"Drug_Consumption.csv\")\ndrug_or <- subset(drug_or, Country != \"Other\")\n```\n\n\nThese three drugs (alcohol, cafeeine and nocotine) are legal in all 6 analyzed countries.\n\n### Alcohol\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Alcohol)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Alcohol\", title = \"Age and Alcohol Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Alcohol, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Alcohol, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Alcohol Consumption\", x = \"Alcohol Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Alcohol, nrow = 4) +\n  labs(title = \"Education and Alcohol Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Alcohol, nrow = 3) +\n  labs(title = \"Country and Alcohol Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n### Caffeine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Caff)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Caffeine\", title = \"Age and Caffeine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Caff, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Caff, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Caffeine Consumption\", x = \"Caffeine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Caff, nrow = 4) +\n  labs(title = \"Education and Caffeine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Caff, nrow = 3) +\n  labs(title = \"Country and Caffeine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n### Nicotine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Nicotine)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Nicotine\", title = \"Age and Nicotine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Nicotine, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Nicotine, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Nicotine Consumption\", x = \"Nicotine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Nicotine, nrow = 4) +\n  labs(title = \"Education and Nicotine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Nicotine, nrow = 3) +\n  labs(title = \"Country and Nicotine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n## **Controversial** Drugs\n\nThis drug (cannabis) is legal in two analyzed countries (the United States and Canada) but illegal in four others.\n\n### Cannabis\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Cannabis)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cannabis\", title = \"Age and Cannabis Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Cannabis, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Cannabis, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cannabis Consumption\", x = \"Cannabis Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Cannabis, nrow = 4) +\n  labs(title = \"Education and Cannabis Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Cannabis, nrow = 3) +\n  labs(title = \"Country and Cannabis Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n## **Illegal** Drugs\n\nThese two drugs (Cocaine, Heroin) are illegal across all six analyzed countries.\n\n### Cocaine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Coke)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cocaine\", title = \"Age and Cocaine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Coke, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Coke, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cocaine Consumption\", x = \"Cocaine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Coke, nrow = 4) +\n  labs(title = \"Education and Cocaine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Coke, nrow = 3) +\n  labs(title = \"Country and Cocaine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n### Heroin\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Heroin)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Heroin\", title = \"Age and Heroin Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Heroin, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Heroin, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Heroin Consumption\", x = \"Heroin Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Heroin, nrow = 4) +\n  labs(title = \"Education and Heroin Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Heroin, nrow = 3) +\n  labs(title = \"Country and Heroin Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n","srcMarkdownNoYaml":"\n\n[How does each demographic characteristic affect the drug consumption patterns?]{style=\"background-color:#fdfd96;\"}\n\n[This univariate analysis page will feature an analysis of four key demographic factors: ***Age, Gender, Education Level, and Country***. The aim is to elucidate their relationship with drug consumption patterns.<br><br> **For reference:** CL0 indicating ‘never used’, CL1 representing ‘used over a decade ago’, CL2 indicating ‘used in the last decade’, CL3 indicating ‘used in the last year’, CL4 representing ‘used in the last month’, CL5 indicating ‘used in the last week’, and CL6 representing ‘used in the last day’.]{style=\"font-size: 12pt; color: gray;\"}\n\n```{r, eval=TRUE, echo=FALSE}\ndrug <- read.csv(\"Drug_Consumption_Quantified.csv\")\ndrug <- subset(drug, Country != \"-0.28519\")\ndrug_or <- read.csv(\"Drug_Consumption.csv\")\ndrug_or <- subset(drug_or, Country != \"Other\")\n```\n\n## **Legal** Drugs\n\nThese three drugs (alcohol, cafeeine and nocotine) are legal in all 6 analyzed countries.\n\n### Alcohol\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Alcohol)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Alcohol\", title = \"Age and Alcohol Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Alcohol, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Alcohol, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Alcohol Consumption\", x = \"Alcohol Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Alcohol, nrow = 4) +\n  labs(title = \"Education and Alcohol Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Alcohol, nrow = 3) +\n  labs(title = \"Country and Alcohol Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n### Caffeine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Caff)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Caffeine\", title = \"Age and Caffeine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Caff, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Caff, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Caffeine Consumption\", x = \"Caffeine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Caff, nrow = 4) +\n  labs(title = \"Education and Caffeine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Caff, nrow = 3) +\n  labs(title = \"Country and Caffeine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n### Nicotine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Nicotine)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Nicotine\", title = \"Age and Nicotine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Nicotine, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Nicotine, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Nicotine Consumption\", x = \"Nicotine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Nicotine, nrow = 4) +\n  labs(title = \"Education and Nicotine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Nicotine, nrow = 3) +\n  labs(title = \"Country and Nicotine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n## **Controversial** Drugs\n\nThis drug (cannabis) is legal in two analyzed countries (the United States and Canada) but illegal in four others.\n\n### Cannabis\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Cannabis)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cannabis\", title = \"Age and Cannabis Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Cannabis, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Cannabis, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cannabis Consumption\", x = \"Cannabis Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Cannabis, nrow = 4) +\n  labs(title = \"Education and Cannabis Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Cannabis, nrow = 3) +\n  labs(title = \"Country and Cannabis Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n## **Illegal** Drugs\n\nThese two drugs (Cocaine, Heroin) are illegal across all six analyzed countries.\n\n### Cocaine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Coke)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cocaine\", title = \"Age and Cocaine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Coke, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Coke, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cocaine Consumption\", x = \"Cocaine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Coke, nrow = 4) +\n  labs(title = \"Education and Cocaine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Coke, nrow = 3) +\n  labs(title = \"Country and Cocaine Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n### Heroin\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Heroin)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Heroin\", title = \"Age and Heroin Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Heroin, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Heroin, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Heroin Consumption\", x = \"Heroin Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-2.43591, -1.73790, -1.43719, -1.22751, -0.61113, -0.05921, 0.45468, 1.16365, 1.98437)\nlabels <- c(\"Left school before 16 years\", \"Left school at 16 years\", \"Left school at 17 years\", \"Left school at 18 years\", \"Some college or university, no certificate or degree\", \"Professional certificate/ diploma\", \"University degree\", \"Masters degree\", \"Doctorate degree\")\n\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\", \"#8aabcc\", \"#88abda\", \"#a3bbdb\", \"#aed0ee\")\n\nggplot(drug, aes(x = factor(Education, labels = labels), fill = factor(Education, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Heroin, nrow = 4) +\n  labs(title = \"Education and Heroin Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Define breaks and labels for alcohol consumption levels (CL0-CL6)\nbreaks <- c(-0.09765, 0.24923, -0.46841, 0.21128, 0.96082, -0.57009)\nlabels <- c(\"Australia\", \"Canada\", \"New Zealand\", \"Republic of Ireland\", \"UK\", \"USA\")\n\n# Define custom colors for each country\ncustom_colors <- c(\"#12264f\", \"#003460\", \"#12507b\", \"#106898\", \"#5976ba\", \"#6f94cd\")\n\nggplot(drug, aes(x = factor(Country, labels = labels), fill = factor(Country, labels = labels))) +\n  geom_bar(position = \"dodge\") +\n  geom_text(stat = \"count\", aes(label = after_stat(count)), position = position_dodge(width = 1), vjust = -0.5, size = 2) +\n  facet_wrap(~ Heroin, nrow = 3) +\n  labs(title = \"Country and Heroin Consumption\", x = \"\", y = \"Count\" ) +\n  theme_minimal() +\n  theme(axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        legend.text = element_text(size = 6),\n        legend.key.size = unit(0.5, \"cm\")) +\n  scale_fill_manual(values = custom_colors) +\n  guides(fill = guide_legend(title = \"Education\")) +\n  ylim(0,250)\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Univariate.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title":"<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}