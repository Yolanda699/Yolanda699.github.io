{"title":"<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>","markdown":{"yaml":{"title":"<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>"},"headingText":"**Legal** Drugs","containsRefs":false,"markdown":"\n\n[How does each demographic characteristic affect the drug consumption patterns?]{style=\"background-color:#fdfd96;\"}\n\n[This univariate analysis page will feature an analysis of four key demographic factors: ***Age, Gender, Education Level, and Country***. The aim is to elucidate their relationship with drug consumption patterns.<br><br> **For reference:** CL0 indicating ‘never used’, CL1 representing ‘used over a decade ago’, CL2 indicating ‘used in the last decade’, CL3 indicating ‘used in the last year’, CL4 representing ‘used in the last month’, CL5 indicating ‘used in the last week’, and CL6 representing ‘used in the last day’. <br><br> **Note:** This dataset contains 1766 participants, with 905 females and 861 males.]{style=\"font-size: 12pt; color: gray;\"}\n\n```{r, eval=TRUE, echo=FALSE}\ndrug <- read.csv(\"Drug_Consumption_Quantified.csv\")\ndrug <- subset(drug, Country != \"-0.28519\")\ndrug_or <- read.csv(\"Drug_Consumption.csv\")\ndrug_or <- subset(drug_or, Country != \"Other\")\n```\n\n\nThese three drugs (alcohol, cafeeine and nocotine) are legal in all 6 analyzed countries.\n\n### Alcohol\n\nThe majority of participants consume alcohol with some regularity, with monthly (CL4), weekly (CL5), or daily (CL6) consumption being the most reported.\n\n**Younger people consume more:** Younger individuals are more likely to have engaged in alcohol consumption more recently, while older age groups show a higher frequency of alcohol consumption in the more distant past, with a notable decline in recent consumption as age progresses.\n\n**Minor difference caused by gender:** While overall gender differences in alcohol consumption appear minimal, there are specific points of divergence. Despite these variations, both genders display a similar pattern of alcohol consumption, with the majority having consumed alcohol at some stage and only a small proportion never having consumed alcohol at all.\n\n**Minor difference caused by educational background:** The data suggests that alcohol consumption patterns, especially at higher consumption levels (such as CL4 and CL5), do not differ significantly across different educational levels. \n\n**Differences seen in more recent consumption:** There is a consistent pattern of alcohol non-consumption to distant past consumption (CL0 to CL2) across the six compared countries. However, when examining more recent alcohol consumption (CL3 to CL6), distinct differences between countries emerge. Specifically, New Zealand, Canada, and the Republic of Ireland exhibit higher frequencies of drinking.\n\n#### Age\n\nThere is an observable overall decline in alcohol consumption as age increases. The proportion of individuals who have never consumed alcohol (CL0) diminishes with advancing age. The peak occurrence for those who last consumed alcohol over a decade ago (CL1) is found within the 45-54 age bracket. The age group most likely to have consumed alcohol in the last decade (CL2) is 35-44. For more recent consumption categories—consumed in the last year (CL3), last month (CL4), last week (CL5), and last day (CL6)—the majority are in the youngest age group, 18-24.\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Alcohol)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Alcohol\", title = \"Age and Alcohol Consumption\")\n```\n\n#### Gender\n\nA smaller portion of the surveyed population, 16.68% of females and 19.05% of males, includes individuals who have never consumed alcohol (CL0) or those who last consumed alcohol up to a year ago (CL3). The overall data suggests that the difference in alcohol consumption patterns between genders is negligible. The largest observed difference is in the weekly consumption category (CL5), where 42.98% of females and 37.51% of males reported consumption, yet this difference is not considered significant.\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Alcohol, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Alcohol, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Alcohol Consumption\", x = \"Alcohol Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\nThe graph illustrates minimal variations in alcohol consumption across different educational levels. While there is a slight trend suggesting higher alcohol consumption among individuals with higher educational backgrounds, the differences are not significant.\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_alcohol_counts <- drug_or %>%\n  group_by(Education, Alcohol) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_alcohol_counts, aes(x = Education, y = percentage, fill = Alcohol)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Alcohol Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\nThe percentages of individuals abstaining from alcohol consumption (CL0) to those who consumed this decade (CL2) exhibit comparable trends across six countries. However, notable disparities emerge among those consuming alcohol within the recent year (CL3) up to consumption within the last day (CL6). New Zealand stands out for a higher prevalence of alcohol consumption this year or last day, while Canada exhibits a higher frequency of consumption within the month, and the Republic of Ireland sees more individuals consuming within the week.\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_alcohol_counts <- drug_or %>%\n  group_by(Country, Alcohol) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_alcohol_counts$Country <- factor(country_alcohol_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_alcohol_counts, aes(x = Country, y = percentage, color = Alcohol, group = Alcohol)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Alcohol Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n### Caffeine\n\n**Younger people consume more:** Younger adults exhibiting more frequent usage. This trend suggests that caffeine consumption may decrease as individuals age, particularly after passing the 55-year mark.\n\n**Minor gender difference:** Both males and females exhibit similar patterns of caffeine consumption, with both genders showing a high level of caffeine intake. There is no significant gender difference influencing the frequency of caffeine consumption.\n\n#### Age\n\nThe data suggests that weekly (CL5) and daily (CL6) caffeine consumption is predominantly observed in the younger age brackets, specifically those aged 18-24 and 25-34. There is a noticeable decline in caffeine consumption among individuals in the 55-64 age group. Furthermore, the peak of caffeine consumption 'over a decade ago' (CL1) is most evident in the 35-44 age category, which aligns with the finding that caffeine consumption is most prevalent among those currently in the 18-24 and 25-34 age groups.\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Caff)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Caffeine\", title = \"Age and Caffeine Consumption\")\n```\n\n#### Gender\n\nThe majority of surveyed individuals consume caffeine either on a daily basis (CL6), with 24.64% female and 29.15% male respondents, or on a weekly basis (CL5), with 42.98% females and 37.51% males. However, the gender difference in caffeine consumption frequency is not significantly pronounced.\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Caff, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Caff, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Caffeine Consumption\", x = \"Caffeine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_caff_counts <- drug_or %>%\n  group_by(Education, Caff) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_caff_counts$Education <- factor(education_caff_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_caff_counts, aes(x = Education, y = percentage, fill = Caff)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Caffeine Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_caff_counts <- drug_or %>%\n  group_by(Country, Caff) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_caff_counts$Country <- factor(country_caff_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_caff_counts, aes(x = Country, y = percentage, color = Caff, group = Caff)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Caffeine Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n### Nicotine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Nicotine)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Nicotine\", title = \"Age and Nicotine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Nicotine, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Nicotine, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Nicotine Consumption\", x = \"Nicotine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_nict_counts <- drug_or %>%\n  group_by(Education, Nicotine) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_nict_counts$Education <- factor(education_nict_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_nict_counts, aes(x = Education, y = percentage, fill = Nicotine)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Nicotine Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_nict_counts <- drug_or %>%\n  group_by(Country, Nicotine) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_nict_counts$Country <- factor(country_nict_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_nict_counts, aes(x = Country, y = percentage, color = Nicotine, group = Nicotine)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Nicotine Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n## **Controversial** Drugs\n\nThis drug (cannabis) is legal in two analyzed countries (the United States and Canada) but illegal in four others.\n\n### Cannabis\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Cannabis)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cannabis\", title = \"Age and Cannabis Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Cannabis, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Cannabis, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cannabis Consumption\", x = \"Cannabis Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_cann_counts <- drug_or %>%\n  group_by(Education, Cannabis) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_cann_counts$Education <- factor(education_cann_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_cann_counts, aes(x = Education, y = percentage, fill = Cannabis)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Cannabis Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_cann_counts <- drug_or %>%\n  group_by(Country, Cannabis) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_cann_counts$Country <- factor(country_cann_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_cann_counts, aes(x = Country, y = percentage, color = Cannabis, group = Cannabis)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Cannabis Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n## **Illegal** Drugs\n\nThese two drugs (Cocaine, Heroin) are illegal across all six analyzed countries.\n\n### Cocaine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Coke)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cocaine\", title = \"Age and Cocaine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Coke, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Coke, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cocaine Consumption\", x = \"Cocaine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_coke_counts <- drug_or %>%\n  group_by(Education, Coke) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_coke_counts$Education <- factor(education_coke_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_coke_counts, aes(x = Education, y = percentage, fill = Coke)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Cocaine Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_coke_counts <- drug_or %>%\n  group_by(Country, Coke) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_coke_counts$Country <- factor(country_coke_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_coke_counts, aes(x = Country, y = percentage, color = Coke, group = Coke)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Cocaine Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n### Heroin\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Heroin)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Heroin\", title = \"Age and Heroin Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Heroin, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Heroin, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Heroin Consumption\", x = \"Heroin Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_hero_counts <- drug_or %>%\n  group_by(Education, Heroin) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_hero_counts$Education <- factor(education_hero_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_hero_counts, aes(x = Education, y = percentage, fill = Heroin)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Heroin Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_hero_counts <- drug_or %>%\n  group_by(Country, Heroin) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_hero_counts$Country <- factor(country_hero_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_hero_counts, aes(x = Country, y = percentage, color = Heroin, group = Heroin)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Heroin Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n","srcMarkdownNoYaml":"\n\n[How does each demographic characteristic affect the drug consumption patterns?]{style=\"background-color:#fdfd96;\"}\n\n[This univariate analysis page will feature an analysis of four key demographic factors: ***Age, Gender, Education Level, and Country***. The aim is to elucidate their relationship with drug consumption patterns.<br><br> **For reference:** CL0 indicating ‘never used’, CL1 representing ‘used over a decade ago’, CL2 indicating ‘used in the last decade’, CL3 indicating ‘used in the last year’, CL4 representing ‘used in the last month’, CL5 indicating ‘used in the last week’, and CL6 representing ‘used in the last day’. <br><br> **Note:** This dataset contains 1766 participants, with 905 females and 861 males.]{style=\"font-size: 12pt; color: gray;\"}\n\n```{r, eval=TRUE, echo=FALSE}\ndrug <- read.csv(\"Drug_Consumption_Quantified.csv\")\ndrug <- subset(drug, Country != \"-0.28519\")\ndrug_or <- read.csv(\"Drug_Consumption.csv\")\ndrug_or <- subset(drug_or, Country != \"Other\")\n```\n\n## **Legal** Drugs\n\nThese three drugs (alcohol, cafeeine and nocotine) are legal in all 6 analyzed countries.\n\n### Alcohol\n\nThe majority of participants consume alcohol with some regularity, with monthly (CL4), weekly (CL5), or daily (CL6) consumption being the most reported.\n\n**Younger people consume more:** Younger individuals are more likely to have engaged in alcohol consumption more recently, while older age groups show a higher frequency of alcohol consumption in the more distant past, with a notable decline in recent consumption as age progresses.\n\n**Minor difference caused by gender:** While overall gender differences in alcohol consumption appear minimal, there are specific points of divergence. Despite these variations, both genders display a similar pattern of alcohol consumption, with the majority having consumed alcohol at some stage and only a small proportion never having consumed alcohol at all.\n\n**Minor difference caused by educational background:** The data suggests that alcohol consumption patterns, especially at higher consumption levels (such as CL4 and CL5), do not differ significantly across different educational levels. \n\n**Differences seen in more recent consumption:** There is a consistent pattern of alcohol non-consumption to distant past consumption (CL0 to CL2) across the six compared countries. However, when examining more recent alcohol consumption (CL3 to CL6), distinct differences between countries emerge. Specifically, New Zealand, Canada, and the Republic of Ireland exhibit higher frequencies of drinking.\n\n#### Age\n\nThere is an observable overall decline in alcohol consumption as age increases. The proportion of individuals who have never consumed alcohol (CL0) diminishes with advancing age. The peak occurrence for those who last consumed alcohol over a decade ago (CL1) is found within the 45-54 age bracket. The age group most likely to have consumed alcohol in the last decade (CL2) is 35-44. For more recent consumption categories—consumed in the last year (CL3), last month (CL4), last week (CL5), and last day (CL6)—the majority are in the youngest age group, 18-24.\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Alcohol)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Alcohol\", title = \"Age and Alcohol Consumption\")\n```\n\n#### Gender\n\nA smaller portion of the surveyed population, 16.68% of females and 19.05% of males, includes individuals who have never consumed alcohol (CL0) or those who last consumed alcohol up to a year ago (CL3). The overall data suggests that the difference in alcohol consumption patterns between genders is negligible. The largest observed difference is in the weekly consumption category (CL5), where 42.98% of females and 37.51% of males reported consumption, yet this difference is not considered significant.\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Alcohol, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Alcohol, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Alcohol Consumption\", x = \"Alcohol Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\nThe graph illustrates minimal variations in alcohol consumption across different educational levels. While there is a slight trend suggesting higher alcohol consumption among individuals with higher educational backgrounds, the differences are not significant.\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_alcohol_counts <- drug_or %>%\n  group_by(Education, Alcohol) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_alcohol_counts, aes(x = Education, y = percentage, fill = Alcohol)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Alcohol Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\nThe percentages of individuals abstaining from alcohol consumption (CL0) to those who consumed this decade (CL2) exhibit comparable trends across six countries. However, notable disparities emerge among those consuming alcohol within the recent year (CL3) up to consumption within the last day (CL6). New Zealand stands out for a higher prevalence of alcohol consumption this year or last day, while Canada exhibits a higher frequency of consumption within the month, and the Republic of Ireland sees more individuals consuming within the week.\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_alcohol_counts <- drug_or %>%\n  group_by(Country, Alcohol) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_alcohol_counts$Country <- factor(country_alcohol_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_alcohol_counts, aes(x = Country, y = percentage, color = Alcohol, group = Alcohol)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Alcohol Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n### Caffeine\n\n**Younger people consume more:** Younger adults exhibiting more frequent usage. This trend suggests that caffeine consumption may decrease as individuals age, particularly after passing the 55-year mark.\n\n**Minor gender difference:** Both males and females exhibit similar patterns of caffeine consumption, with both genders showing a high level of caffeine intake. There is no significant gender difference influencing the frequency of caffeine consumption.\n\n#### Age\n\nThe data suggests that weekly (CL5) and daily (CL6) caffeine consumption is predominantly observed in the younger age brackets, specifically those aged 18-24 and 25-34. There is a noticeable decline in caffeine consumption among individuals in the 55-64 age group. Furthermore, the peak of caffeine consumption 'over a decade ago' (CL1) is most evident in the 35-44 age category, which aligns with the finding that caffeine consumption is most prevalent among those currently in the 18-24 and 25-34 age groups.\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Caff)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Caffeine\", title = \"Age and Caffeine Consumption\")\n```\n\n#### Gender\n\nThe majority of surveyed individuals consume caffeine either on a daily basis (CL6), with 24.64% female and 29.15% male respondents, or on a weekly basis (CL5), with 42.98% females and 37.51% males. However, the gender difference in caffeine consumption frequency is not significantly pronounced.\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Caff, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Caff, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Caffeine Consumption\", x = \"Caffeine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_caff_counts <- drug_or %>%\n  group_by(Education, Caff) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_caff_counts$Education <- factor(education_caff_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_caff_counts, aes(x = Education, y = percentage, fill = Caff)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Caffeine Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_caff_counts <- drug_or %>%\n  group_by(Country, Caff) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_caff_counts$Country <- factor(country_caff_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_caff_counts, aes(x = Country, y = percentage, color = Caff, group = Caff)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Caffeine Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n### Nicotine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Nicotine)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Nicotine\", title = \"Age and Nicotine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Nicotine, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Nicotine, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Nicotine Consumption\", x = \"Nicotine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_nict_counts <- drug_or %>%\n  group_by(Education, Nicotine) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_nict_counts$Education <- factor(education_nict_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_nict_counts, aes(x = Education, y = percentage, fill = Nicotine)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Nicotine Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_nict_counts <- drug_or %>%\n  group_by(Country, Nicotine) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_nict_counts$Country <- factor(country_nict_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_nict_counts, aes(x = Country, y = percentage, color = Nicotine, group = Nicotine)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Nicotine Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n## **Controversial** Drugs\n\nThis drug (cannabis) is legal in two analyzed countries (the United States and Canada) but illegal in four others.\n\n### Cannabis\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Cannabis)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cannabis\", title = \"Age and Cannabis Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Cannabis, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Cannabis, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cannabis Consumption\", x = \"Cannabis Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_cann_counts <- drug_or %>%\n  group_by(Education, Cannabis) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_cann_counts$Education <- factor(education_cann_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_cann_counts, aes(x = Education, y = percentage, fill = Cannabis)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Cannabis Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_cann_counts <- drug_or %>%\n  group_by(Country, Cannabis) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_cann_counts$Country <- factor(country_cann_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_cann_counts, aes(x = Country, y = percentage, color = Cannabis, group = Cannabis)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Cannabis Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n## **Illegal** Drugs\n\nThese two drugs (Cocaine, Heroin) are illegal across all six analyzed countries.\n\n### Cocaine\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Coke)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Cocaine\", title = \"Age and Cocaine Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Coke, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Coke, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Cocaine Consumption\", x = \"Cocaine Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_coke_counts <- drug_or %>%\n  group_by(Education, Coke) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_coke_counts$Education <- factor(education_coke_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_coke_counts, aes(x = Education, y = percentage, fill = Coke)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Cocaine Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_coke_counts <- drug_or %>%\n  group_by(Country, Coke) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_coke_counts$Country <- factor(country_coke_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_coke_counts, aes(x = Country, y = percentage, color = Coke, group = Coke)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Cocaine Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n\n### Heroin\n\n#### Age\n\n```{r, eval=TRUE, echo=FALSE}\nlibrary(ggplot2)\n\nbreaks <- c(-0.95197, -0.07854, 0.49788, 1.09449, 1.82213, 2.59171)\nlabels <- c(\"18-24\", \"25-34\", \"35-44\", \"45-54\", \"55-64\", \"65+\")\n\nggplot(drug, aes(x = Age, y = Heroin)) +\n  geom_violin() +\n  scale_x_continuous(breaks = breaks, labels = labels) +\n  labs(x = \"Age\", y = \"Heroin\", title = \"Age and Heroin Consumption\")\n```\n\n#### Gender\n\n```{r, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncount_data <- drug_or %>%\n  group_by(Heroin, Gender) %>%\n  summarise(count = n())\n\ncustom_colors <- c(\"F\" = \"#aed0ee\", \"M\" = \"#a3bbdb\")\n\nggplot(count_data, aes(x = Heroin, y = count, fill = Gender)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(aes(label = count), position = position_dodge(width = 1), vjust = -0.5, size = 3) +\n  labs(title = \"Gender and Heroin Consumption\", x = \"Heroin Consumption Levels\", y = \"Count\") +\n  scale_fill_manual(values = custom_colors) +\n  theme_minimal()\n```\n\n#### Education\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\neducation_hero_counts <- drug_or %>%\n  group_by(Education, Heroin) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Education) %>%\n  mutate(percentage = count / sum(count) * 100)\n\neducation_levels_ordered <- c(\n  \"Doctorate degree\", \"Masters degree\", \"University degree\",\n  \"Professional certificate/ diploma\", \n  \"Some college or university, no certificate or degree\", \n  \"Left school at 18 years\", \"Left school at 17 years\",\n  \"Left school at 16 years\", \"Left school before 16 years\"\n)\neducation_hero_counts$Education <- factor(education_hero_counts$Education, levels = education_levels_ordered)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(education_hero_counts, aes(x = Education, y = percentage, fill = Heroin)) +\n  geom_bar(stat = \"identity\") +\n  scale_fill_manual(values = custom_colours, name = \"Consumption Level\") +\n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Education and Heroin Consumption\",\n       x = \"Education Level\",\n       y = \"Percentage\",\n       fill = \"Consumption Level\")\n```\n\n#### Country\n\n```{r, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}\nlibrary(ggplot2)\nlibrary(dplyr)\n\ncountry_hero_counts <- drug_or %>%\n  group_by(Country, Heroin) %>%\n  summarise(count = n(), .groups = 'drop') %>%\n  group_by(Country) %>%\n  mutate(percentage = count / sum(count) * 100)\n\ncountry_hero_counts$Country <- factor(country_hero_counts$Country)\n\ncustom_colours <- c(\"#aed0ee\", \"#a3bbdb\", \"#88abda\", \"#8aabcc\", \"#6f94cd\", \"#5976ba\", \"#106898\", \"#12507b\", \"#003460\")\n\nggplot(country_hero_counts, aes(x = Country, y = percentage, color = Heroin, group = Heroin)) +\n  geom_line() +\n  geom_point() +\n  scale_color_manual(values = custom_colours, name = \"Consumption Level\") +\n  scale_y_continuous(limits = c(0, 100), expand = c(0, 0)) + \n  theme_minimal() +\n  theme(\n    legend.position = \"right\",\n    axis.text.x = element_text(angle = 45, hjust = 1)  # Rotate x-axis labels for better readability\n  ) +\n  labs(title = \"Country and Heroin Consumption\",\n       x = \"Countries of origin\",\n       y = \"Percentage\",\n       color = \"Consumption Level\")\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Univariate.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title":"<span style='font-size: 30px;'>Demographic Characteristics</span><span style='font-size: 20px; color:gray;'> [Univariate Analysis] </span>"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}