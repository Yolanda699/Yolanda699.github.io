strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 10), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.5), size = 3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.5), size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.5,hjust=0.5), size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
vjust = 0.5, hjust=0.5), size = 2.3,
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5),
aes(label = paste0(round(percentage), "%")),
size = 2.3,
color = "white",
hjust = 1.5,  # Adjust horizontal justification
vjust = 0.5)  # Adjust vertical justification
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5),
aes(label = paste0(round(percentage), "%")),
size = 2.3,
color = "white",
hjust = 0.5,  # Adjust horizontal justification
vjust = 0.5)  # Adjust vertical justification
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5),
aes(label = paste0(round(percentage), "%")),
size = 2.3,
color = "white",
hjust = 0,  # Adjust horizontal justification
vjust = 0.5)  # Adjust vertical justification
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5),
aes(label = paste0(round(percentage), "%")),
size = 2.3,
color = "white",
vjust = 0.5)  # Adjust vertical justification
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.5), size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.5), size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100) %>%
arrange(Education, desc(Alcohol)) %>% # Arrange to ensure labels are stacked correctly
mutate(cumsum = cumsum(percentage),
mid_point = cumsum - (0.5 * percentage))
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~Education, strip.position = "bottom") +
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 10),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 3), # Adjust this threshold as needed
aes(y = mid_point, label = paste0(round(percentage, 1), "%")),
size = 3, # Adjust text size as needed
colour = "white",
position = position_stack(vjust = 0.5)) # You may need to adjust vjust to fine-tune the label positions
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.5), size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.6), size = 2.3,
color = "white")
library(ggplot2)
library(dplyr)
library(scales)
library(stringr)
# Assuming 'drug_or' is already loaded and contains the necessary columns
education_alcohol_counts <- drug_or %>%
group_by(Education, Alcohol) %>%
summarise(count = n(), .groups = 'drop') %>%
group_by(Education) %>%
mutate(percentage = count / sum(count) * 100)
education_levels_ordered <- c(
"Doctorate degree", "Masters degree", "University degree",
"Professional certificate/ diploma",
"Some college or university, no certificate or degree",
"Left school at 18 years", "Left school at 17 years",
"Left school at 16 years", "Left school before 16 years"
)
education_alcohol_counts$Education <- factor(education_alcohol_counts$Education, levels = education_levels_ordered)
custom_colours <- c("#aed0ee", "#a3bbdb", "#88abda", "#8aabcc", "#6f94cd", "#5976ba", "#106898", "#12507b", "#003460")
ggplot(education_alcohol_counts, aes(x = "", y = percentage, fill = Alcohol)) +
geom_bar(stat = "identity", width = 1) +
coord_polar("y", start = 0) +
facet_wrap(~str_wrap(Education, width = 40), strip.position = "bottom") + # Adjust the width as needed
scale_fill_manual(values = custom_colours) +
theme_void() +
theme(
legend.position = "right",
strip.text = element_text(size = 6),
strip.placement = "outside"
) +
labs(title = "Education and Alcohol Consumption",
fill = "Consumption Level") +
geom_text(data = subset(education_alcohol_counts, percentage > 5), aes(label = paste0(round(percentage), "%")),
position = position_stack(vjust = 0.65), size = 2.3,
color = "white")
